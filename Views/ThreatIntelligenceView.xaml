<Page x:Class="SkidrowKiller.Views.ThreatIntelligenceView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="{StaticResource BgPrimaryBrush}">

    <StackPanel Margin="24">
        <!-- Header -->
        <StackPanel Margin="0,0,0,20">
            <TextBlock Text="Threat Intelligence"
                       FontSize="28" FontWeight="Bold"
                       Foreground="{StaticResource TextPrimaryBrush}"/>
            <TextBlock Text="Multi-source threat database updates from ClamAV, abuse.ch, YARA rules, and more"
                       FontSize="14" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Stats Cards -->
        <Grid Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Total Hashes -->
            <Border Grid.Column="0" Background="{StaticResource BgCardBrush}"
                    CornerRadius="8" Padding="16" Margin="0,0,8,0">
                <StackPanel>
                    <TextBlock Text="Malware Hashes" FontSize="12"
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtTotalHashes" Text="0" FontSize="24" FontWeight="Bold"
                               Foreground="{StaticResource AccentPrimaryBrush}" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- URLs -->
            <Border Grid.Column="1" Background="{StaticResource BgCardBrush}"
                    CornerRadius="8" Padding="16" Margin="4,0,4,0">
                <StackPanel>
                    <TextBlock Text="Malicious URLs" FontSize="12"
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtTotalUrls" Text="0" FontSize="24" FontWeight="Bold"
                               Foreground="{StaticResource WarningBrush}" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- IPs -->
            <Border Grid.Column="2" Background="{StaticResource BgCardBrush}"
                    CornerRadius="8" Padding="16" Margin="4,0,4,0">
                <StackPanel>
                    <TextBlock Text="C&amp;C IPs" FontSize="12"
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtTotalIPs" Text="0" FontSize="24" FontWeight="Bold"
                               Foreground="{StaticResource DangerBrush}" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>

            <!-- YARA Rules -->
            <Border Grid.Column="3" Background="{StaticResource BgCardBrush}"
                    CornerRadius="8" Padding="16" Margin="8,0,0,0">
                <StackPanel>
                    <TextBlock Text="YARA Rules" FontSize="12"
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtTotalYara" Text="0" FontSize="24" FontWeight="Bold"
                               Foreground="{StaticResource SuccessBrush}" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Update Progress Panel -->
        <Border x:Name="ProgressPanel" Background="{StaticResource BgCardBrush}"
                CornerRadius="8" Padding="20" Margin="0,0,0,20" Visibility="Collapsed">
            <StackPanel>
                <Grid Margin="0,0,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock x:Name="TxtProgressStatus" Grid.Column="0" Text="Initializing..."
                               FontSize="16" FontWeight="SemiBold"
                               Foreground="{StaticResource TextPrimaryBrush}"/>
                    <TextBlock x:Name="TxtProgressPercent" Grid.Column="1" Text="0%"
                               FontSize="16" FontWeight="Bold"
                               Foreground="{StaticResource AccentPrimaryBrush}"/>
                </Grid>

                <!-- Main Progress Bar -->
                <ProgressBar x:Name="MainProgressBar" Height="8" Maximum="100" Value="0"
                             Foreground="{StaticResource AccentPrimaryBrush}"
                             Background="{StaticResource BgTertiaryBrush}"/>

                <!-- Current Feed Info -->
                <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                    <TextBlock Text="Current: " FontSize="12"
                               Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtCurrentFeed" Text="-" FontSize="12"
                               Foreground="{StaticResource TextPrimaryBrush}"/>
                    <TextBlock x:Name="TxtFeedCount" Text="(0/0)" FontSize="12"
                               Foreground="{StaticResource TextTertiaryBrush}" Margin="8,0,0,0"/>
                </StackPanel>

                <!-- Cancel Button -->
                <Button x:Name="BtnCancel" Content="Cancel"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Click="BtnCancel_Click" HorizontalAlignment="Right"
                        Margin="0,12,0,0" Width="100"/>
            </StackPanel>
        </Border>

        <!-- License Tier Info -->
        <Border x:Name="TierInfoPanel" Background="{StaticResource BgCardBrush}"
                CornerRadius="8" Padding="16" Margin="0,0,0,20">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="Current Tier: " FontSize="14"
                                   Foreground="{StaticResource TextSecondaryBrush}"/>
                        <TextBlock x:Name="TxtCurrentTier" Text="Free" FontSize="14" FontWeight="Bold"
                                   Foreground="{StaticResource AccentPrimaryBrush}"/>
                    </StackPanel>
                    <TextBlock x:Name="TxtAvailableFeeds" Text="5 of 12 feeds available"
                               FontSize="12" Foreground="{StaticResource TextTertiaryBrush}" Margin="0,4,0,0"/>
                </StackPanel>

                <Button x:Name="BtnUpgrade" Grid.Column="1" Content="Upgrade"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Click="BtnUpgrade_Click" Width="100"/>
            </Grid>
        </Border>

        <!-- Feed List -->
        <Border Background="{StaticResource BgCardBrush}" CornerRadius="8" Padding="16">
            <StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                    <TextBlock Text="Available Feeds" FontSize="16" FontWeight="SemiBold"
                               Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="TxtLastUpdate" Text="Last update: Never" FontSize="12"
                               Foreground="{StaticResource TextTertiaryBrush}"
                               VerticalAlignment="Center" Margin="16,0,0,0"/>
                </StackPanel>

                <!-- Feed Items -->
                <ItemsControl x:Name="FeedsList">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Background="{StaticResource BgTertiaryBrush}"
                                    CornerRadius="4" Padding="12" Margin="0,0,0,8">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>

                                    <StackPanel Grid.Column="0">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="{Binding Name}" FontWeight="SemiBold"
                                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                                            <Border Background="{Binding TierColor}" CornerRadius="2"
                                                    Padding="6,2" Margin="8,0,0,0">
                                                <TextBlock Text="{Binding TierDisplay}" FontSize="10"
                                                           Foreground="White"/>
                                            </Border>
                                        </StackPanel>
                                        <TextBlock Text="{Binding CategoryDisplay}" FontSize="12"
                                                   Foreground="{StaticResource TextSecondaryBrush}" Margin="0,2,0,0"/>
                                    </StackPanel>

                                    <TextBlock Grid.Column="1" Text="{Binding StatusText}" FontSize="12"
                                               Foreground="{Binding StatusColor}" VerticalAlignment="Center"
                                               Margin="0,0,16,0"/>

                                    <TextBlock Grid.Column="2" Text="{Binding ItemCountText}" FontSize="12"
                                               Foreground="{StaticResource TextTertiaryBrush}"
                                               VerticalAlignment="Center"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Border>

        <!-- Action Buttons -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,20,0,0">
            <Button x:Name="BtnRefresh" Content="Refresh List"
                    Style="{StaticResource SecondaryButtonStyle}"
                    Click="BtnRefresh_Click" Width="120"/>
            <Button x:Name="BtnUpdateAll" Content="Update All"
                    Style="{StaticResource PrimaryButtonStyle}"
                    Click="BtnUpdateAll_Click" Width="120" Margin="12,0,0,0"/>
        </StackPanel>
    </StackPanel>
</Page>
