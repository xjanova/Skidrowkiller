<Page x:Class="SkidrowKiller.Views.UsbProtectionView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Background="Transparent">

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="USB Protection" FontSize="28" FontWeight="Bold"
                           Foreground="{StaticResource TextPrimaryBrush}"/>
                <Border x:Name="StatusBadge" CornerRadius="4" Padding="8,4" Margin="12,0,0,0"
                        VerticalAlignment="Center" Background="{StaticResource SuccessBrush}">
                    <TextBlock x:Name="StatusText" Text="Active" FontSize="11" FontWeight="SemiBold" Foreground="White"/>
                </Border>
            </StackPanel>
            <TextBlock Text="Monitor and protect against infected USB drives and autorun malware"
                       FontSize="14" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,4,0,0"/>
        </StackPanel>

        <!-- Quick Stats -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Connected Devices -->
            <Border Grid.Column="0" Background="{StaticResource BgCardBrush}" CornerRadius="8" Padding="16" Margin="0,0,8,0">
                <StackPanel>
                    <TextBlock Text="Connected" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtDeviceCount" Text="0" FontSize="28" FontWeight="Bold"
                               Foreground="{StaticResource AccentPrimaryBrush}" Margin="0,4,0,0"/>
                    <TextBlock Text="USB Devices" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}"/>
                </StackPanel>
            </Border>

            <!-- Scanned -->
            <Border Grid.Column="1" Background="{StaticResource BgCardBrush}" CornerRadius="8" Padding="16" Margin="4,0">
                <StackPanel>
                    <TextBlock Text="Scanned" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtScannedCount" Text="0" FontSize="28" FontWeight="Bold"
                               Foreground="{StaticResource SuccessBrush}" Margin="0,4,0,0"/>
                    <TextBlock Text="Drives Today" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}"/>
                </StackPanel>
            </Border>

            <!-- Threats Blocked -->
            <Border Grid.Column="2" Background="{StaticResource BgCardBrush}" CornerRadius="8" Padding="16" Margin="4,0">
                <StackPanel>
                    <TextBlock Text="Blocked" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtThreatsBlocked" Text="0" FontSize="28" FontWeight="Bold"
                               Foreground="{StaticResource WarningBrush}" Margin="0,4,0,0"/>
                    <TextBlock Text="Autorun Files" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}"/>
                </StackPanel>
            </Border>

            <!-- Threats Found -->
            <Border Grid.Column="3" Background="{StaticResource BgCardBrush}" CornerRadius="8" Padding="16" Margin="8,0,0,0">
                <StackPanel>
                    <TextBlock Text="Detected" FontSize="12" Foreground="{StaticResource TextSecondaryBrush}"/>
                    <TextBlock x:Name="TxtThreatsFound" Text="0" FontSize="28" FontWeight="Bold"
                               Foreground="{StaticResource DangerBrush}" Margin="0,4,0,0"/>
                    <TextBlock Text="Threats" FontSize="11" Foreground="{StaticResource TextTertiaryBrush}"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Connected Devices Section -->
        <Border Grid.Row="2" Background="{StaticResource BgCardBrush}" CornerRadius="8" Padding="16" Margin="0,0,0,16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                    <TextBlock Text="Connected USB Devices" FontSize="16" FontWeight="SemiBold"
                               Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Empty State -->
                <Border x:Name="NoDevicesPanel" Grid.Row="1" Background="{StaticResource BgTertiaryBrush}"
                        CornerRadius="8" Padding="24">
                    <StackPanel HorizontalAlignment="Center">
                        <TextBlock Text="No USB devices connected" FontSize="14"
                                   Foreground="{StaticResource TextSecondaryBrush}" HorizontalAlignment="Center"/>
                        <TextBlock Text="Connect a USB drive to scan it for threats" FontSize="12"
                                   Foreground="{StaticResource TextTertiaryBrush}" HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Devices List -->
                <ItemsControl x:Name="DevicesList" Grid.Row="1" Visibility="Collapsed">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </Grid>
        </Border>

        <!-- Activity Log -->
        <Border Grid.Row="3" Background="{StaticResource BgCardBrush}" CornerRadius="8" Padding="16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12">
                    <TextBlock Text="Activity Log" FontSize="16" FontWeight="SemiBold"
                               Foreground="{StaticResource TextPrimaryBrush}" VerticalAlignment="Center"/>
                    <Button x:Name="BtnClearLog" Content="Clear"
                            Style="{StaticResource SecondaryButtonStyle}"
                            Click="BtnClearLog_Click" Padding="12,4" Margin="12,0,0,0"
                            FontSize="11"/>
                </StackPanel>

                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto"
                              Style="{StaticResource ModernScrollViewerStyle}">
                    <StackPanel x:Name="LogPanel">
                        <TextBlock x:Name="EmptyLogText" Text="No activity yet. USB events will appear here."
                                   FontSize="12" Foreground="{StaticResource TextTertiaryBrush}"
                                   HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,20"/>
                    </StackPanel>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- Actions -->
        <Grid Grid.Row="4" Margin="0,16,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Settings -->
            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <CheckBox x:Name="ChkAutoScan" Content="Auto-scan on connect" IsChecked="True"
                          Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center"
                          Checked="ChkAutoScan_Changed" Unchecked="ChkAutoScan_Changed"/>
                <CheckBox x:Name="ChkBlockAutorun" Content="Block autorun.inf" IsChecked="True"
                          Foreground="{StaticResource TextSecondaryBrush}" VerticalAlignment="Center" Margin="20,0,0,0"
                          Checked="ChkBlockAutorun_Changed" Unchecked="ChkBlockAutorun_Changed"/>
            </StackPanel>

            <!-- Buttons -->
            <StackPanel Grid.Column="1" Orientation="Horizontal">
                <Button x:Name="BtnToggleProtection" Content="Stop Protection"
                        Style="{StaticResource SecondaryButtonStyle}"
                        Click="BtnToggleProtection_Click" Width="140"/>
                <Button x:Name="BtnScanAll" Content="Scan All USB"
                        Style="{StaticResource PrimaryButtonStyle}"
                        Click="BtnScanAll_Click" Width="140" Margin="12,0,0,0"/>
            </StackPanel>
        </Grid>
    </Grid>
</Page>
